selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
# Model 1: Elastic net regression
set.seed(1234)
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
# Model 1: Elastic net regression
set.seed()
# Model 1: Elastic net regression
set.seed(1)
# Model 1: Elastic net regression
set.seed(1)
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
# Model 1: Elastic net regression
set.seed(12)
# Model 1: Elastic net regression
set.seed(12)
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
# Model 1: Elastic net regression
set.seed(123)
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
# Model 1: Elastic net regression
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-4)
best_lambda <- model_en$lambda.min
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
best_lambda <- model_en$lambda.1se
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
plot(model_en)
# Model 1: Elastic net regression
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-10)
plot(model_en)
# Model 1: Elastic net regression
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-20)
plot(model_en)
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
plot(model_en)
# Model 1: Elastic net regression
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-10, type.measure = "deviance")
best_lambda <- model_en$lambda.min
plot(model_en)
en_coef <- coef(model_en, s = best_lambda)
plot(model_en)
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
colnames(x_train)
# Model 1: Elastic net regression
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-10, type.measure = "mse")
best_lambda <- model_en$lambda.min
plot(model_en)
# Model 1: Elastic net regression
model_en <- cv.glmnet(x_train, exp(y_train), alpha = 0.5, lambda.min.ratio = 1e-10, type.measure = "mse")
best_lambda <- model_en$lambda.min
plot(model_en)
colnames(x_train)
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
# we include the quadratic term for Average.Rating, as per our exploratory analysis
x_train <- cbind(x_train, training$Average.Rating^2)
colnames(x_train)[ncol(x_train)] <- "Average.Rating2"
y_train <- training$My.Rating
xy_train <- as.data.frame(cbind(y_train, x_train))
colnames(xy_train)[1] <- "My.Rating"
x_val <- model.matrix(~ . - 1, data = validation[, predictor_cols])
x_val <- cbind(x_val, validation$Average.Rating^2)
colnames(x_val)[ncol(x_val)] <- "Average.Rating2"
y_val <- validation$My.Rating
xy_val <- as.data.frame(cbind(y_val, x_val))
colnames(xy_val)[1] <- "My.Rating"
x_test <- model.matrix(~ . - 1, data = testing[, predictor_cols])
x_test <- cbind(x_test, testing$Average.Rating^2)
# Model 1: Elastic net regression
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-10, type.measure = "mse")
best_lambda <- model_en$lambda.min
plot(model_en)
colnames(x_train)
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
# Evaluate on validation set
predictions_val <- predict(model_en, s = best_lambda, newx = x_val)
# Remove response from predictors
predictor_cols <- predictor_cols[!predictor_cols %in% c("My.Rating", "Set")]
# Prepare the model matrix and the response in both sets
x_train <- model.matrix(~ ., data = training[, predictor_cols])[,-1]
# Identify predictor columns present in all sets
predictor_cols <- intersect(colnames(training), colnames(validation))
# remove NAs in the features we want to use
mybooks_clean <- mybooks %>% filter(!is.na(Average.Rating) & !is.na(Number.of.Pages) & !is.na(Original.Publication.Year))
# remove NAs in the features we want to use
mybooks_clean <- mybooks %>% filter(!is.na(Average.Rating) & !is.na(Number.of.Pages) & !is.na(Original.Publication.Year))
# Transform Authorgender into a dummy
mybooks_clean$FemaleAuthor <- ifelse(mybooks_clean$AuthorGender == "female", 1, 0)
mybooks_clean$FemaleAuthor[is.na(mybooks_clean$AuthorGender)] <- 0
mybooks_clean <- mybooks_clean %>% select(-AuthorGender)
# create a dummy column for each author nationality and keep the 10 most common
top_nationalities <- mybooks_clean %>%
group_by(AuthorNationality) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
head(10) %>%
pull(AuthorNationality)
# attach the dummies for nationalities, without spaces
for(nation in top_nationalities) {
mybooks_clean[[gsub(" ", "_", nation)]] <- ifelse(mybooks_clean$AuthorNationality == nation, 1, 0)
}
mybooks_clean <- mybooks_clean %>% select(-AuthorNationality)
top_tags <- tags$SubjectList[1:100]
for(tag in top_tags) {
# remove space at the beginning and end, substitute with _ if in the middle
clean_tag <- trimws(tag)
col_name <- gsub(" ", "_", clean_tag)
mybooks_clean[[col_name]] <- ifelse(grepl(paste0("\\b", clean_tag, "\\b"), mybooks_clean$Subjects), 1, 0)
}
mybooks_clean <- mybooks_clean %>% select(-Subjects)
mybooks_clean <- mybooks_clean %>% select(-Subjects)
read_clean <- mybooks_clean %>% filter(Exclusive.Shelf == "read")
tbr_clean <- mybooks_clean %>% filter(Exclusive.Shelf == "to-read")
read_clean <- read_clean %>% select(-c(Title, Author, Date.Read, Exclusive.Shelf, Season.Read))
# Use log-transform as response, remove NAs in response
read_clean <- read_clean %>% filter(!is.na(My.Rating))
training <- read_clean %>% filter(Set == "Train")
testing <- tbr_clean
# first, scale the numeric predictors
training <- training %>%
mutate(Average.Rating = scale(Average.Rating),
Number.of.Pages = scale(Number.of.Pages),
Original.Publication.Year = scale(Original.Publication.Year))
validation <- validation %>%
mutate(Average.Rating = scale(Average.Rating),
Number.of.Pages = scale(Number.of.Pages),
Original.Publication.Year = scale(Original.Publication.Year))
testing <- testing %>%
mutate(Average.Rating = scale(Average.Rating),
Number.of.Pages = scale(Number.of.Pages),
Original.Publication.Year = scale(Original.Publication.Year))
# Identify predictor columns present in all sets
predictor_cols <- intersect(colnames(training), colnames(validation))
# Remove response from predictors
predictor_cols <- predictor_cols[!predictor_cols %in% c("My.Rating", "Set")]
# Prepare the model matrix and the response in both sets
x_train <- model.matrix(~ ., data = training[, predictor_cols])[,-1]
# we include the quadratic term for Average.Rating, as per our exploratory analysis
x_train <- cbind(x_train, training$Average.Rating^2)
colnames(x_train)[ncol(x_train)] <- "Average.Rating2"
y_train <- training$My.Rating
xy_train <- as.data.frame(cbind(y_train, x_train))
colnames(xy_train)[1] <- "My.Rating"
x_val <- model.matrix(~ . - 1, data = validation[, predictor_cols])
x_val <- cbind(x_val, validation$Average.Rating^2)
colnames(x_val)[ncol(x_val)] <- "Average.Rating2"
y_val <- validation$My.Rating
xy_val <- as.data.frame(cbind(y_val, x_val))
colnames(xy_val)[1] <- "My.Rating"
x_test <- model.matrix(~ . - 1, data = testing[, predictor_cols])
x_test <- cbind(x_test, testing$Average.Rating^2)
# Model 1: Elastic net regression
model_en <- cv.glmnet(x_train, y_train, alpha = 0.5, lambda.min.ratio = 1e-10, type.measure = "mse")
best_lambda <- model_en$lambda.min
plot(model_en)
en_coef <- coef(model_en, s = best_lambda)
selected_vars <- rownames(en_coef)[which(en_coef != 0)]
selected_vars
# Evaluate on validation set
predictions_val <- predict(model_en, s = best_lambda, newx = x_val)
mse_en <- mean((y_val - predictions_val)^2)
print(paste("Validation MSE (Elastic net):", round(mse_en, 4)))
# Model 2: Random Forest
model_rf <- randomForest(My.Rating ~ ., data = xy_train,
ntree = 500, mtry = 10, importance = TRUE)
varImpPlot(model_rf, main = "Variable Importance (Random Forest)")
# Evaluate on validation set
predictions_val_rf <- predict(model_rf, newdata = xy_val)
mse_rf <- mean((y_val - predictions_val_rf)^2)
print(paste("Validation MSE (Random Forest):", round(mse_rf, 4)))
print(paste("Validation MSE (Elastic net):", round(mse_en, 4)))
# Predict ratings for the to-read list with the elastic net model
predictions_test <- predict(model_en, s = best_lambda, newx = x_test)
predicted_ratings <- predictions_test  # back-transform
tbr_clean$Predicted.My.Rating <- as.numeric(predicted_ratings)
tbr_clean <- tbr_clean %>%
arrange(desc(Predicted.My.Rating)) %>%
select(Title, Author, Predicted.My.Rating)
# Table of top 10 recommended books to read
top10_recommendations <- tbr_clean[1:10, ]
knitr::kable(top10_recommendations, col.names = c("Title", "Author", "Predicted My Rating"), digits = 2)
ggraph(tags_graph, layout = "kk") +
geom_edge_link(aes(alpha = rescale(weight)), width = 1, color = "gray70", show.legend = TRUE) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_point(aes(size = rescale(degree)), color = "lightsteelblue3", show.legend = FALSE) +
geom_node_text(aes(label = str_wrap(name, width = 10)), size = 4, max.overlaps = 10, repel = TRUE, family = "sans") +
theme_void() +
labs(title = "Tag Co-Occurrence Network") +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 20, face = "bold.italic"))
tags_cooccur <- mybooks_tags %>%
filter(Set == "Train") %>%
select(Title, Subjects) %>%
distinct() %>%
pairwise_count(item = Subjects, feature = Title, sort = TRUE)
tags_cooccur <- tags_cooccur %>% filter(n >= 3)  # only keep edges with at least 3 co-occurrences
tags_nodes <- data.frame(name = unique(c(tags_cooccur$item1, tags_cooccur$item2)))
tags_edges <- tags_cooccur %>% rename(from = item1, to = item2, weight = n)
tags_graph <- graph_from_data_frame(d = tags_edges, vertices = tags_nodes, directed = FALSE)
V(tags_graph)$degree <- scales::rescale(degree(tags_graph), to = c(3,12))
ggraph(tags_graph, layout = "kk") +
geom_edge_link(aes(alpha = rescale(weight)), width = 1, color = "gray70", show.legend = TRUE) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_point(aes(size = rescale(degree)), color = "lightsteelblue3", show.legend = FALSE) +
geom_node_text(aes(label = str_wrap(name, width = 10)), size = 4, max.overlaps = 10, repel = TRUE, family = "sans") +
theme_void() +
labs(title = "Tag Co-Occurrence Network") +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 20, face = "bold.italic"))
ggraph(tags_graph, layout = "kk") +
geom_edge_link(aes(alpha = rescale(weight)), width = 1, color = "gray70", show.legend = TRUE) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_point(aes(size = rescale(degree)), color = "lightsteelblue4", show.legend = FALSE) +
geom_node_text(aes(label = str_wrap(name, width = 10)), size = 4, max.overlaps = 10, repel = TRUE, family = "sans") +
theme_void() +
labs(title = "Tag Co-Occurrence Network") +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 20, face = "bold.italic"))
ggraph(tags_graph, layout = "kk") +
geom_edge_link(aes(alpha = rescale(weight)), width = 1, color = "gray70", show.legend = TRUE) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_point(aes(size = rescale(degree)), color = "lightsteelblue", show.legend = FALSE) +
geom_node_text(aes(label = str_wrap(name, width = 10)), size = 4, max.overlaps = 10, repel = TRUE, family = "sans") +
theme_void() +
labs(title = "Tag Co-Occurrence Network") +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 20, face = "bold.italic"))
ggraph(tags_graph, layout = "kk") +
geom_edge_link(aes(alpha = rescale(weight)), width = 1, color = "gray70", show.legend = TRUE) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_point(aes(size = rescale(degree)), color = "lightsteelblue3", show.legend = FALSE) +
geom_node_text(aes(label = str_wrap(name, width = 10)), size = 4, max.overlaps = 10, repel = TRUE, family = "sans") +
theme_void() +
labs(title = "Tag Co-Occurrence Network") +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 20, face = "bold.italic"))
ggraph(tags_graph, layout = "kk") +
geom_edge_link(aes(alpha = rescale(weight)), width = 1, color = "gray70", show.legend = TRUE) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_point(aes(size = rescale(degree)), color = "lightsteelblue3", show.legend = FALSE) +
geom_node_text(aes(label = str_wrap(name, width = 10)), size = 4, max.overlaps = 10, repel = TRUE, family = "sans") +
theme_void() +
labs(title = "Tag Co-Occurrence Network") +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 20, face = "bold.italic"))
